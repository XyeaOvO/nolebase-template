## 第四章 IIR数字滤波器的设计 🧐

### 1. 引言与概述

*   **重要性** 🌱：IIR (Infinite Impulse Response) 数字滤波器在数字信号处理领域应用广泛，扮演着至关重要的角色。
*   **应用领域** 💡：
    *   **音频处理**: 降噪、均衡器、压缩编码、语音识别/合成等。
    *   **图像图形处理**: 图像增强、压缩、识别、计算机视觉、动画等。
    *   **通信**: 数字按键电话、时钟恢复、自适应均衡、加密、回波抵消、IP电话、软件无线电等。
    *   **消费电子及其他**: 数字广播/电视、CD/DVD、数码相机、游戏、工业控制、医疗、军事等。
*   **滤波器基本概念** 📊：
    *   **滤波器 (Filter)**: 用于选择所需的一个或多个频带的信号，同时抑制其他频带信号的系统。
    *   **通带 (Passband)**: 允许信号通过的频带。其边缘频率称为 **通带截止频率** ($\omega_p$ 或 $\Omega_p$)。
    *   **阻带 (Stopband)**: 抑制信号或噪声通过的频带。其边缘频率称为 **阻带起始频率** ($\omega_s$ 或 $\Omega_s$)。
    *   **过渡带 (Transition Band)**: 从通带到阻带过渡的频率范围。
    *   ![](Pic/Pasted%20image%2020250430110126.png)
*   **滤波器分类** 📚：
    *   **按输入输出信号**: 模拟滤波器 vs 数字滤波器。
    *   **按通频带**:
        *   **低通滤波器 (LPF)**: 允许低频通过，抑制高频。
        *   **高通滤波器 (HPF)**: 允许高频通过，抑制低频。
        *   **带通滤波器 (BPF)**: 允许特定频带通过。
        *   **带阻滤波器 (BRF)**: 抑制特定频带通过（例如，滤除电视信号中的色度信号以得亮度信号）。
    *   **按单位冲激响应/网络结构**: IIR DF (无限冲激响应数字滤波器) vs FIR DF (有限冲激响应数字滤波器)。

### 2. IIR 数字滤波器的技术指标 (数字域) ✨

*   **核心指标**: 通常用 **幅频特性** $|H(e^{j\omega})|$ 来描述。
    *   **通带截止频率**: $\omega_p$
    *   **通带波动 (衰减)**:
        *   相对指标: $A_p$ (dB)
        *   绝对指标: 通带容限 $\delta_p$
    *   **阻带起始频率**: $\omega_s$
    *   **阻带衰减**:
        *   相对指标: $A_s$ (dB)
        *   绝对指标: 阻带容限 $\delta_s$
*   **图示**:
    ![](Pic/Pasted%20image%2020250430110430.png)
*   **说明**:
    *   设计目标通常是让 $|H(e^{j\omega})|$ 满足指标要求。
    *   相位特性 $\phi(\omega)$ 可以通过全通滤波器等手段进行校正。
    *   由于 $H(e^{j\omega})$ 的周期性和对称性，通常只需关注 $0 \le \omega \le \pi$ 范围。
*   **绝对指标与相对指标的关系** 🔄:
    *   假设 $|H(e^{j\omega})|_{max} = 1$ (归一化)。
    *   通带要求: $1-\delta_p \le |H(e^{j\omega})| \le 1$, for $|\omega| \le \omega_p$
    *   阻带要求: $|H(e^{j\omega})| \le \delta_s$, for $\omega_s \le |\omega| \le \pi$
    *   换算公式：
        *   $A_p = -20 \log_{10}(1-\delta_p)$ (dB)
        *   $A_s = -20 \log_{10}(\delta_s)$ (dB)
    *   幅度与 dB 衰减的关系：
        $\boxed{ A(\omega) \text{ (dB)} = -20 \log_{10} \frac{|H(e^{j\omega})|}{|H(e^{j\omega})|_{max}} }$

### 3. IIR 数字滤波器设计概述 (基于模拟原型) 🧭

*   **目标**: 根据数字域指标 ($\omega_p, \omega_s, A_p, A_s$) 求解系统函数 $H(z)$。
*   **IIR 系统函数**:
    $$ H(z) = \frac{\sum_{k=0}^{M} b_k z^{-k}}{1 - \sum_{k=1}^{N} a_k z^{-k}} = A \frac{\prod_{i=1}^{M} (z-c_i)}{\prod_{i=1}^{N} (z-d_i)} $$
    设计目的即确定系数 $a_k, b_k$ 或零极点 $c_i, d_i$。
*   **核心思路**: 利用成熟的模拟滤波器设计理论。
    1.  **S平面逼近**: 设计满足指标要求的 **模拟滤波器** $H_a(s)$。
    2.  **Z平面逼近**: 将模拟滤波器 $H_a(s)$ 转换为 **数字滤波器** $H(z)$ (通过冲激响应不变法或双线性变换法等)。
*   **设计流程 (模拟原型法)**:
    *   **方法1 (频率变换在模拟域)**:
        1.  数字指标 -> 模拟指标 (预畸变，若用双线性变换)
        2.  设计模拟低通原型 $H_{LP}(s')$
        3.  模拟频率变换 $s' \to s$ (低通->低通/高通/带通/带阻)，得到目标模拟滤波器 $H_a(s)$
        4.  $s \to z$ 变换，得到数字滤波器 $H(z)$
    *   **方法2 (频率变换在数字域)**:
        1.  数字指标 -> 模拟低通指标 (预畸变，若用双线性变换)
        2.  设计模拟低通原型 $H_{LP}(s)$
        3.  $s \to z$ 变换 (低通)，得到数字低通原型 $H_{LP}(z)$
        4.  数字频率变换 $z \to z'$ (低通->低通/高通/带通/带阻)，得到目标数字滤波器 $H(z')$
*   **优势**: 模拟滤波器设计理论成熟，有完备的图表可查，简化设计过程。

### 4. 模拟滤波器的设计 (基础) 🛠️

#### 4.1 模拟域性能指标 (以低通为例)

*   **频率响应**: $H_a(j\Omega)$
*   **幅度平方响应指标** (通常基于归一化幅度)：
    *   通带: $\boxed{ \frac{1}{1+\epsilon^2} \le |H_a(j\Omega)|^2 \le 1, \quad |\Omega| \le \Omega_p }$
    *   阻带: $\boxed{ 0 \le |H_a(j\Omega)|^2 \le \frac{1}{A^2}, \quad |\Omega| \ge \Omega_s }$
*   **参数定义**:
    *   $\epsilon$: 通带内波动系数 (决定通带最大衰减)
    *   $A$: 阻带衰减参数 (决定阻带最小衰减)
    *   $\Omega_p$: 通带截止频率
    *   $\Omega_s$: 阻带起始频率
    *   $\Omega_c$: 3dB 截止频率 (幅度平方响应为 0.5 或幅度为 $1/\sqrt{2}$ 时的频率)
    *   **归一化**: 常将 $\Omega_p$ 或 $\Omega_c$ 归一化为 1。
*   **图示**: ![](Pic/Pasted%20image%2020250430111526.png)

#### 4.2 模拟滤波器的逼近原理

*   **为什么需要逼近?** 🤔
    *   理想滤波器 (如理想低通) 具有矩形幅度响应和线性相位响应。
    *   ![](Pic/Pasted%20image%2020250430111808.png))
    *   理想滤波器的冲激响应 $h(t)$ 是非因果的 (例如，理想低通对应 $sinc(t)$ 函数)，且无限长，**无法物理实现**。
*   **逼近方法**: 采用 **多项式** 或 **有理分式** 来逼近理想滤波器的特性。
    *   目标是找到一个可实现的系统函数 $H_a(s)$，其频率响应 $H_a(j\Omega)$ 在通带和阻带内尽可能接近理想特性，并满足给定的技术指标。

#### 4.3 理想滤波器回顾与频率响应性质 🧠

*   **理想滤波器定义**: 若系统输出 $y(t) = k \cdot x(t-t_d)$ ($k$ 为常数增益, $t_d$ 为恒定延迟)，则为理想滤波器。
*   **频率响应**: $H(j\Omega) = k e^{-j\Omega t_d}$
    *   **幅度特性**: $|H(j\Omega)| = k$ (常数，对所有频率分量放大倍数相同)
    *   **相位特性**: $Arg[H(j\Omega)] = -\Omega t_d$ (线性相位，保证信号无失真传输)
*   **不现实的**: 理想低通滤波器的冲激响应是 $sinc$ 函数，无限长且非因果。
*   **从 $|H_a(j\Omega)|$ 求解 $H_a(s)$**
    *   **前提**: 设计时常先得到满足要求的幅度平方函数 $|H_a(j\Omega)|^2$。
    *   **关键关系**:
        $\boxed{ |H_a(j\Omega)|^2 = H_a(s)H_a(-s)|_{s=j\Omega} }$
    *   **推导**:
        1.  $H_a(j\Omega) = P(\Omega) - jQ(\Omega)$, 其中 $P(\Omega)$ 是 $\Omega$ 的偶函数，$Q(\Omega)$ 是 $\Omega$ 的奇函数 (对于实系数 $h_a(t)$)。
        2.  $|H_a(j\Omega)|^2 = P^2(\Omega) + Q^2(\Omega)$，是 $\Omega^2$ 的函数，即 $\Omega$ 的偶函数。
        3.  $H_a(-j\Omega) = P(\Omega) + jQ(\Omega) = H_a^*(j\Omega)$ (共轭对称)。
        4.  因此，$|H_a(j\Omega)|^2 = H_a(j\Omega) H_a^*(j\Omega) = H_a(j\Omega) H_a(-j\Omega)$。
        5.  解析延拓：令 $s=j\Omega$, $\Omega = -js$。则 $\Omega^2 = -s^2$。
        6.  得到**幅度平方函数**: $|H_a(s)|^2 \equiv |H_a(j\Omega)|^2|_{\Omega^2=-s^2} = H_a(s)H_a(-s)$。这是一个关于 $s^2$ 的实系数有理函数。
    *   **求解步骤**:
        1.  得到 $H_a(s)H_a(-s)$ 的表达式。
        2.  求出 $H_a(s)H_a(-s)$ 的**所有零点和极点**。这些零极点关于 $s$ 平面的虚轴和实轴都成对(或四重)对称。
        3.  **选择极点**: 为了得到**稳定且因果**的系统 $H_a(s)$，选择 $H_a(s)H_a(-s)$ 在 **$s$ 左半平面 (LHP)** 的所有极点作为 $H_a(s)$ 的极点。
        4.  **选择零点**:
            *   若要求**最小相位系统**，则选择 $H_a(s)H_a(-s)$ 在 **$s$ 左半平面** 的所有零点作为 $H_a(s)$ 的零点。
            *   若无最小相位要求，LHP 和 RHP (右半平面) 的零点可以任意分配给 $H_a(s)$ 和 $H_a(-s)$，只要保证共轭零点成对出现即可。虚轴上的零点必须是偶数阶， $H_a(s)$ 和 $H_a(-s)$ 各取一半。
        5.  **确定增益**: 根据 $H_a(s)$ 在 $s=0$ (低通) 或 $s=\infty$ (高通) 处的增益要求确定比例因子 $K_0$。
    *   **系统函数形式**:
        $$ H_a(s) = K_0 \frac{(s-z_0)(s-z_1)\cdots(s-z_m)}{(s-p_0)(s-p_1)\cdots(s-p_n)} $$
        其中 $p_i$ 均为 LHP 极点，$z_i$ 为所选零点。
    *   **示例**:
        *   给定 $|H(j\Omega)|^2 = \frac{4(\Omega^4+64)}{\Omega^4 - 10\Omega^2 + 169}$
        *   令 $\Omega^2 = -s^2$, 得 $H(s)H(-s) = \frac{4(s^4+64)}{s^4 + 10s^2 + 169}$
        *   求得极点: $\pm 2 \pm 3j$ (四个)
        *   求得零点: $\pm 2 \pm 2j$ (四个)
        *   为保证稳定，选择 LHP 极点: $s = -2+3j, s = -2-3j$。
        *   选择一对共轭零点 (例如 LHP 零点，若要求最小相位): $s = -2+2j, s = -2-2j$。
        *   构成 $H(s) = K_0 \frac{(s - (-2+2j))(s - (-2-2j))}{(s - (-2+3j))(s - (-2-3j))} = K_0 \frac{s^2+4s+8}{s^2+4s+13}$。
        *   根据低频增益 $|H(j0)|^2 = 4 \times 64 / 169 \Rightarrow |H(j0)| = 16/13$。而 $H(0) = K_0 \frac{8}{13}$。令 $H(0)=|H(j0)|$ (假设直流增益为正)，则 $K_0 = 2$。
        *   最终 $H(s) = \frac{2(s^2+4s+8)}{s^2+4s+13} = \frac{2s^2+8s+16}{s^2+4s+13}$。

#### 4.4 模拟滤波器逼近方法概述

*   **技术要求 (LPF)**:
    *   通带截止频率 $\Omega_p$
    *   通带最大衰减 $A_p$ (或 $\epsilon$)
    *   阻带起始频率 $\Omega_s$
    *   阻带最小衰减 $A_s$ (或 $A$)
*   **衰减特性 $A(\Omega)$**:
    *   定义: $A(\Omega) = 10 \log_{10} \frac{P_{in}}{P_{out}} = 10 \log_{10} \left| \frac{X(j\Omega)}{Y(j\Omega)} \right|^2 = 10 \log_{10} \frac{1}{|H_a(j\Omega)|^2} = -20 \log_{10} |H_a(j\Omega)|$ (假设输入阻抗等于输出负载阻抗 )。
*   **特征函数 (逼近函数) $K(j\Omega)$**:
    *   由于直接逼近 $|H_a(j\Omega)|$ 不方便，引入特征函数 $K(j\Omega)$。
    *   关系： $\boxed{ |H_a(j\Omega)|^2 = \frac{1}{1+|K(j\Omega)|^2} }$
    *   等价地： $\boxed{ |K(j\Omega)|^2 = 10^{A(\Omega)/10} - 1 }$
    *   设计目标转化为：找到一个关于 $\Omega$ 的**多项式或有理函数** $|K(j\Omega)|^2$，使其在通带内接近 0，在阻带内足够大。
*   **常见逼近类型**:
    1.  **巴特沃思 (Butterworth) 逼近**: 最大平坦特性。
    2.  **切比雪夫 (Chebyshev) 逼近**: 通带或阻带等波纹特性。
    3.  **逆切比雪夫逼近**: 通带平坦，阻带等波纹。
    4.  **椭圆 (Elliptic / Cauer) 逼近**: 通带和阻带都等波纹，过渡带最窄。

### 5. 巴特沃思 (Butterworth) 低通滤波器设计 ⭐

#### 5.1 Butterworth 逼近特性

*   **幅度平方函数**:
    $\boxed{ |H_a(j\Omega)|^2 = \frac{1}{1+(\Omega/\Omega_c)^{2N}} }$
    *   $N$: 滤波器的 **阶数** (Order)，正整数。
    *   $\Omega_c$: **3dB 截止频率** (rad/s)，此时 $|H_a(j\Omega_c)|^2 = 1/2$。
    *   也称为 B 型滤波器。
*   **特点**:
    1.  **3dB 点不变性**: 幅度在 $\Omega = \Omega_c$ 时恒为 $-3$dB ($1/\sqrt{2}$)，与阶数 $N$ 无关。因此 $\Omega_c$ 称为 3dB 带宽。
        *   $-10 \log_{10} |H_a(j\Omega_c)|^2 = -10 \log_{10}(1/2) \approx 3$dB。
    2.  **单调下降性**: 幅度响应在整个频带内 ($0 \le \Omega < \infty$) 是单调递减的。
    3.  **最大平坦性 (Maximally Flat)**: 在 $\Omega=0$ 附近具有最大程度的平坦性。$|H_a(j\Omega)|^2$ 对 $\Omega$ 的各阶导数在 $\Omega=0$ 处，前 $(2N-1)$ 阶均为零。
        *   在 $\Omega \to 0$ 时， $|H_a(j\Omega)|^2 \to 1$。
        *   在 $\Omega \to \infty$ 时， $|H_a(j\Omega)|^2 \to 0$。衰减速率为 $-20N$ dB/十倍频程。
*   **阶数 $N$ 的影响**:
    *   $N$ 越大，通带内越平坦，过渡带越窄 (越陡峭)，阻带衰减越大，越接近理想低通滤波器。
    *   ![](Pic/Pasted%20image%2020250430132322.png)
*   **性质总结**:
    *   N 越大，特性越接近理想矩形。
    *   是 "全极点型" 滤波器，所有零点都在 $s=\infty$。

#### 5.2 Butterworth 设计步骤 (公式法)

1.  **确定阶数 N**: 🚩
    *   根据给定的通带指标 ($\Omega_p, A_p$) 和阻带指标 ($\Omega_s, A_s$) 计算所需最小阶数。
    *   在 $\Omega = \Omega_p$ 处: $A_p = 10 \log_{10} [1 + (\Omega_p/\Omega_c)^{2N}]$
    *   在 $\Omega = \Omega_s$ 处: $A_s = 10 \log_{10} [1 + (\Omega_s/\Omega_c)^{2N}]$
    *   消去 $\Omega_c$ (或先假设 $\Omega_c$ )，得到 N 的计算公式：
        $\boxed{ N \ge \frac{\log_{10}[(10^{0.1A_s}-1)/(10^{0.1A_p}-1)]}{2 \log_{10}(\Omega_s/\Omega_p)} }$
    *   $N$ 必须取 **不小于** 计算结果的 **最小整数**。

2.  **确定 3dB 截止频率 $\Omega_c$**: ⏱️
    *   得到整数阶数 $N$ 后，可以利用通带或阻带指标之一精确计算 $\Omega_c$。
    *   利用通带指标: $\boxed{ \Omega_c = \frac{\Omega_p}{(10^{0.1A_p}-1)^{1/(2N)}} }$ (按此计算，滤波器在 $\Omega_p$ 处刚好满足 $A_p$ 要求)
    *   利用阻带指标: $\boxed{ \Omega_c = \frac{\Omega_s}{(10^{0.1A_s}-1)^{1/(2N)}} }$ (按此计算，滤波器在 $\Omega_s$ 处刚好满足 $A_s$ 要求)
    *   通常选择使指标更严格的那个边界来计算 $\Omega_c$，或者取两者计算结果中对设计更有利的值 (例如，如果希望通带尽可能宽，则用 $A_p$ 计算；如果希望阻带衰减尽快开始，则用 $A_s$ 计算，通常取较小值以保证两边都满足)。如果 $A_p$ 恰好是 3dB，则 $\Omega_c = \Omega_p$。

3.  **求归一化系统函数 $H(p)$**:  
    *   **归一化**: 令 $p = s/\Omega_c$，设计一个 3dB 截止频率为 1 的归一化低通原型 $H(p)$。
    *   幅度平方函数: $|H(p)|^2 = \frac{1}{1+(-p^2)^N} = \frac{1}{1+(-1)^N p^{2N}}$。
    *   归一化系统函数: $H(p)H(-p) = \frac{1}{1+(-1)^N p^{2N}}$。
    *   **极点**: $H(p)H(-p)$ 的极点是方程 $1+(-1)^N p^{2N} = 0$ 的根，即 $p^{2N} = -1 = e^{j(\pi + 2k\pi)}$ (N 为偶) 或 $p^{2N} = 1 = e^{j2k\pi}$ (N 为奇)。合并为：
        $\boxed{ p_k = e^{j\frac{\pi(2k+N+1)}{2N}} = e^{j\frac{\pi}{2}} e^{j\frac{\pi(2k+1)}{2N}}, \quad k=0, 1, \dots, 2N-1 }$
    *   这些 $2N$ 个极点均匀分布在 $p$ 平面的**单位圆**上，角间距为 $\pi/N$。
    *   **极点分布特性**:
        *   极点关于虚轴对称。
        *   没有极点落在虚轴上。
        *   若 N 为奇数，则在负实轴上有极点 $p=-1$。若 N 为偶数，则实轴上无极点。
        *   第一个 LHP 极点与虚轴夹角为 $\pi/(2N)$ (从 $j$ 轴正向算起)。
        ![](Pic/Pasted%20image%2020250430135417.png)
    *   **选择 LHP 极点**: 为保证系统稳定，选择 $2N$ 个极点中位于**左半平面 (LHP)** 的 $N$ 个极点作为 $H(p)$ 的极点。这些极点对应于 $k=0, 1, \dots, N-1$。
        $\boxed{ p_k = e^{j\frac{\pi}{2}} e^{j\frac{\pi(2k+1)}{2N}}, \quad k=0, 1, \dots, N-1 }$
    *   **归一化系统函数**:
        $\boxed{ H(p) = \frac{1}{\prod_{k=0}^{N-1} (p - p_k)} }$ (增益 $H(0)=1$)

4.  **求实际系统函数 $H_a(s)$ (反归一化)**: 
    *   将 $p = s/\Omega_c$ 代入归一化的 $H(p)$ 即可。
        $\boxed{ H_a(s) = H(p)|_{p=s/\Omega_c} = \frac{(\Omega_c)^N}{\prod_{k=0}^{N-1} (s - p_k \Omega_c)} }$

#### 5.3 Butterworth 设计步骤 (查表/图法) 📈📉

1.  **频率归一化**:
    *   选择一个参考频率，通常是 $\Omega_p$。令 $\lambda = \Omega/\Omega_p$。
    *   通带边缘 $\lambda_p = 1$。
    *   阻带边缘 $\lambda_s = \Omega_s / \Omega_p$。
    *   **示例**: $\Omega_p=5kHz, A_p=3dB, \Omega_s=10kHz, A_s=30dB \implies \lambda_p=1, \lambda_s = 10/5 = 2$。
    *   **注意**: 如果提供的表格/图形是以 **3dB 频率 $\Omega_c$** 作为参考频率归一化的，则需要先估算或计算 $\Omega_c$。但常见的图表是以 $\Omega_p$ 为参考（尤其当 $A_p$ 非 3dB 时），或直接提供衰减 vs $\Omega/\Omega_c$。

2.  **查图确定阶数 N**:
    *   使用 **巴特沃思滤波器归一化幅度特性图** (衰减 dB vs 归一化频率 $\lambda$ 或 $\Omega/\Omega_c$)。
    *   在图上找到满足通带衰减 $A_p$ (在 $\lambda=1$ 处) 和阻带衰减 $A_s$ (在 $\lambda_s$ 处) 的最低阶数 $N$ 的曲线。
    *   ![](Pic/Pasted%20image%2020250430135702.png) (右图更常用，纵轴为总衰减)

3.  **查表确定归一化 $H(p)$ 的分母多项式**:
    *   根据阶数 $N$，查找 **归一化巴特沃思低通滤波器分母多项式表**。表中通常给出 $B_N(p) = \prod_{k=0}^{N-1} (p-p_k)$ 的系数。
    *   $H(p) = 1 / B_N(p)$。
    *   ![](Pic/Pasted%20image%2020250430140002.png)

4.  **确定 $\Omega_c$**:
    *   如果图表是以 $\Omega_c$ 归一化的，可以直接使用。
    *   如果图表是以 $\Omega_p$ 归一化，并且 $A_p \ne 3dB$，需要用步骤 5.2 中的公式计算 $\Omega_c$。
    *   如果 $A_p = 3dB$，则 $\Omega_c = \Omega_p$。

5.  **反归一化得到 $H_a(s)$**:
    *   将 $p = s/\Omega_c$ 代入 $H(p) = 1/B_N(p)$。

*   **图表法示例**:
    *   指标: $\Omega_p = 2\pi \cdot 5k$, $A_p=3dB$, $\Omega_s = 2\pi \cdot 10k$, $A_s=30dB$。
    *   (1) 归一化 (以 $\Omega_c = \Omega_p = 2\pi \cdot 5k$ 为参考): $\lambda_p = 1$, $\lambda_s = 10k/5k = 2$。$A_p=3dB, A_s=30dB$。
    *   (2) 查图 (衰减 vs $\Omega/\Omega_c$): 在 $\Omega/\Omega_c=2$ 处，要求衰减 $A_s \ge 30dB$。查图可知 $N=5$ 时满足要求 (N=4 约 24dB，N=5 约 30dB 多)。取 $N=5$。
    *   (3) 查表 (N=5): $H(p) = \frac{1}{(p+1)(p^2+0.6180p+1)(p^2+1.6180p+1)}$。
    *   (4) 确定 $\Omega_c$: 因为 $A_p=3dB$, 所以 $\Omega_c = \Omega_p = 2\pi \cdot 5000 = \pi \cdot 10^4$ rad/s。
    *   (5) 反归一化 $p = s/(\pi \cdot 10^4)$:
        $H_a(s) = \frac{(\pi 10^4)^5}{(s+\pi 10^4)[s^2+0.618(\pi 10^4)s+(\pi 10^4)^2][s^2+1.618(\pi 10^4)s+(\pi 10^4)^2]}$

#### 5.4 Matlab 实现 💻

*   `[n, Wn] = buttord(Wp, Ws, Rp, Rs, 's')`: 计算巴特沃思滤波器的阶数 `n` 和 3dB 截止频率 `Wn` ($\Omega_c$)。
    *   `Wp`, `Ws`: 通带和阻带边缘频率 (rad/s)。
    *   `Rp`, `Rs`: 通带最大衰减和阻带最小衰减 (dB)。
    *   `'s'`: 指明是模拟滤波器设计。
*   `[z, p, k] = buttap(n)`: 计算 `n` 阶归一化 (Wn=1) 巴特沃思模拟低通滤波器的零点 `z` (空矩阵)、极点 `p` 和增益 `k`。
*   `[b, a] = zp2tf(z, p, k)`: 将零极点增益转换为传递函数系数 `b` (分子), `a` (分母)。
*   `H = tf(b, a)`: 创建传递函数模型。
*   `[H, w] = freqs(b, a, N)`: 计算模拟滤波器的频率响应 `H`，在 `N` 个频率点 `w` 处。
*   **注意**: Matlab 的 `buttap` 给出的是归一化 $H(p)$ 的零极点。要得到实际的 $H_a(s)$，需要使用 `buttord` 计算出的 $Wn=\Omega_c$ 进行反归一化 ($s = p \cdot Wn$)，或者直接使用 `butter(n, Wn, 's')` 函数得到 $H_a(s)$ 的系数 `[b,a]`。

#### 5.5 Butterworth 设计小结与局限性

*   **设计流程总结图**: ![](Pic/Pasted%20image%2020250430140120.png)
*   **B 型滤波器缺点**:
    *   为了保证通带内的平坦性 (尤其在 $\Omega=0$ 附近)，是以牺牲过渡带的宽度为代价的。在阶数 $N$ 不变的情况下，其过渡带相对较宽。
    *   在通带截止频率 $\Omega_p$ 附近，逼近特性并不好 (除非 $N$ 很大)。衰减在 $\Omega=0$ 时为 0，而在 $\Omega=\Omega_c$ 时固定为 3dB。
*   **改进思路**:
    *   将指标精度要求均匀分布在整个通带或阻带内，即采用 **等波纹逼近** (如切比雪夫、椭圆滤波器)，可以在相同阶数下获得更窄的过渡带。

---

**下一部分将涉及切比雪夫滤波器、冲激响应不变法、双线性变换法等内容。**